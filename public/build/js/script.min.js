angular.module("StarterApp",["ui.router","ngMaterial","angular-loading-bar","restangular","ngMdIcons","toastr","app.authservice","app.userService","app.MainCtrl","app.HomeCtrl","app.LoginCtrl"]).run(["$rootScope","$state","$location","$stateParams","userService",function(e,t,n,o,a){e.previousState="",e.currentState="",e.isAuthenticated=a.checkIfLoggedIn(),e.$state=t,e.$stateParams=o,e.$on("$stateChangeSuccess",function(t,n,o,a,r){e.previousState=a.name,e.currentState=n.name,e.returnToStateParams=r.id,console.log("current state: "+e.currentState)}),e.$on("$routeChangeError",function(e,t,n,o){console.log(o)})}]).config(["cfpLoadingBarProvider","$stateProvider","$urlMatcherFactoryProvider","$urlRouterProvider","RestangularProvider","toastrConfig","$mdThemingProvider",function(e,t,n,o,a,r,i){var l=i.extendPalette("light-blue",{contrastDefaultColor:"light",contrastDarkColors:["50"],50:"ffffff"});i.definePalette("customBlue",l),i.theme("default").primaryPalette("customBlue",{default:"500","hue-1":"50"}).accentPalette("pink"),i.theme("input","default").primaryPalette("grey"),angular.extend(r,{autoDismiss:!1,containerId:"toast-container",maxOpened:0,newestOnTop:!0,positionClass:"toast-top-right",preventDuplicates:!1,preventOpenDuplicates:!1,target:"body"}),e.includeSpinner=!0,n.caseInsensitive(!0);var c="";a.setBaseUrl(c),a.addResponseInterceptor(function(e,t){var n;return n="getList"===t?e.data:e}),n.caseInsensitive(!0),t.state({name:"main",abstract:!0,templateUrl:"views/main.html",controller:"MainCtrl"}).state({name:"main.home",title:"Home",url:"/",templateUrl:"views/home.html",controller:"HomeCtrl"}).state({name:"main.login",title:"Login",url:"/login",templateUrl:"views/login.html",controller:"LoginCtrl"}).state({name:"main.404",title:"404",url:"/404",templateUrl:"views/404.html"}),o.otherwise("/404")}]),angular.module("app.MainCtrl",[]).controller("MainCtrl",["$scope","$location","$state","$rootScope","$mdBottomSheet","$mdSidenav","$mdDialog","$timeout","authService","$log","$interval","userService",function(e,t,n,o,a,r,i,l,c,s,u,h){e.logout=function(){h.logout(),o.isAuthenticated=null,n.go("main.login")},e.refresh=function(){e.currentToken=h.getCurrentToken()},e.currentToken="",e.refresh(),e.toggleSearch=function(t){e.showSearch=!e.showSearch},e.toggleSidenav=function(t){r(t).toggle(),"left"==t&&(e.openInfo=!e.openInfo)},e.menu=[{link:"",title:"Dashboard",icon:"dashboard"},{link:"",title:"Friends",icon:"people"},{link:"",title:"Messages",icon:"mail"}],e.admin=[{link:"",title:"Trash",icon:"delete"},{link:"showListBottomSheet($event)",title:"Settings",icon:"settings"}],e.alert="",e.items=[{name:"Share",icon:"social:ic_share_24px"},{name:"Upload",icon:"file:ic_cloud_upload_24px"},{name:"Copy",icon:"content:ic_content_copy_24px"},{name:"Print this page",icon:"action:ic_print_24px"}],e.listItemClick=function(t){var n=e.items[t];a.hide(n)},e.showListBottomSheet=function(t){e.alert="",a.show({templateUrl:"views/partials/bottomSheet.html",controller:"MainCtrl",targetEvent:t}).then(function(t){e.alert=t.name+" clicked!"})},e.customFullscreen=!1,e.hide=function(){i.hide()},e.cancel=function(){i.cancel()},e.answer=function(e){i.hide(e)},e.showAdd=function(t){i.show({controller:"MainCtrl",templateUrl:"views/partials/newUser.html",targetEvent:t,clickOutsideToClose:!0,fullscreen:e.customFullscreen}).then(function(t){e.alert='You said the information was "'+t+'".'},function(){e.alert="You cancelled the dialog."})}}]),angular.module("app.HomeCtrl",[]).controller("HomeCtrl",["$scope","$rootScope","$state",function(e,t,n){e.activity=[{what:"Brunch this weekend?",who:"Ali Conners",avatar:"svg-1",when:"3:08PM",notes:" I'll be in your neighborhood doing errands"},{what:"Summer BBQ",who:"to Alex, Scott, Jennifer",avatar:"svg-2",when:"3:08PM",notes:"Wish I could come out but I'm out of town this weekend"},{what:"Oui Oui",who:"Sandra Adams",avatar:"svg-3",when:"3:08PM",notes:"Do you have Paris recommendations? Have you ever been?"},{what:"Birthday Gift",who:"Trevor Hansen",avatar:"svg-4",when:"3:08PM",notes:"Have any ideas of what we should get Heidi for her birthday?"},{what:"Recipe to try",who:"Brian Holt",avatar:"svg-5",when:"3:08PM",notes:"We should eat this: Grapefruit, Squash, Corn, and Tomatillo tacos"}]}]),angular.module("app.LoginCtrl",[]).controller("LoginCtrl",["$scope","$state","userService","$mdToast","$rootScope","toastr",function(e,t,n,o,a,r){e.loginData={},e.doLogin=function(){n.login(e.loginData.email,e.loginData.password,function(e){a.isAuthenticated=!0,r.success("Welcome"),t.go("main.home")},function(e){r.error("Something went wrong with the login process. Try again later!")})},n.checkIfLoggedIn()&&t.go("main.home")}]),angular.module("app.authservice",["LocalStorageModule"]).factory("authService",["localStorageService",function(e){var t={};return t.checkIfLoggedIn=function(){return!!e.get("token")},t.logout=function(){e.remove("token")},t.getCurrentToken=function(){return e.get("token")},t}]),angular.module("app.userService",[]).factory("userService",["localStorageService","$rootScope","Restangular",function(e,t,n){function o(){return e.get("token")}function a(t,n,o,a,r){$http.post("/api/auth/signup",{name:t,email:n,password:o}).then(function(t){e.set("token",t.data.token),a(t)},function(e){r(e)})}function r(t,o,a,r){n.all("authenticate").post({email:t,password:o}).then(function(t){e.set("token",t.token),a(t)},function(e){r(e)})}function i(){e.remove("token")}function l(){return e.get("token")}function c(e,t){n.one("authenticated_user").get().then(function(t){e(t.user)},function(e){t(e)})}return{checkIfLoggedIn:o,signup:a,login:r,logout:i,getCurrentToken:l,getAuthenticatedUser:c}}]);